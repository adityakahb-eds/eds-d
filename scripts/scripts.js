import{$,createElement}from"./__constants.js";import{AUDIENCES,decorateBlocks,decorateIcons,decorateSections,decorateTemplateAndTheme,getAllMetadata,getMetadata,loadCSS,loadFooter,loadHeader,loadSections,loadSkipToMain,pluginContext,pluginPath}from"./aem.js";import{decorateButtons,decorateDisplayTexts,decorateIntroAndSmallParagraphs,decorateSectionTitle}from"./decorators.js";import decorateExternalImages from"./external-image.js";export function decorateMain(e){decorateIcons(e),decorateSections(e),decorateBlocks(e),decorateExternalImages(e),decorateSectionTitle(e)}function invokeCustomDecorators(e){decorateButtons(e),decorateDisplayTexts(e),decorateIntroAndSmallParagraphs(e)}async function loadEager(e){if(getMetadata("experiment")||Object.keys(getAllMetadata("campaign")).length||Object.keys(getAllMetadata("audience")).length){const{loadEager:e}=await import(pluginPath);await e(document,{audiences:AUDIENCES},pluginContext)}const a=$(e,"main");a&&(loadHeader($(e,"header")),loadFooter($(e,"footer")),decorateTemplateAndTheme(),decorateMain(a),loadSkipToMain(),invokeCustomDecorators(e.body),document.body.classList.add("appear"))}async function loadLazy(e){const a=$(e,"main");await loadSections(a),loadCSS(`${window.hlx.codeBasePath}/styles/lazy-styles.css`);const t=createElement("script");if(t.defer=!0,t.src=`${window.hlx.codeBasePath}/scripts/head.js`,t.type="module",setTimeout(()=>{e.head.append(t)},0),getMetadata("experiment")||Object.keys(getAllMetadata("campaign")).length||Object.keys(getAllMetadata("audience")).length){const{loadLazy:e}=await import(pluginPath);await e(document,{audiences:AUDIENCES},pluginContext)}}function loadDelayed(){}async function loadPage(){await loadEager(document),await loadLazy(document),loadDelayed()}loadPage();