{"version":3,"sources":["scripts/scripts.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,CAAC,EAAE,aAAa,EAAE,MAAM,eAAe,CAAC;AACjD,OAAO,EACL,SAAS;AACT,cAAc;AACd,cAAc,EACd,aAAa,EACb,gBAAgB,EAChB,wBAAwB,EACxB,cAAc,EACd,WAAW,EACX,OAAO,EACP,UAAU,EACV,UAAU;AACV,eAAe;AACf,YAAY,EACZ,cAAc,EACd,aAAa,EACb,UAAU;AACV,qBAAqB;EACtB,MAAM,UAAU,CAAC;AAElB,OAAO,EACL,eAAe,EACf,oBAAoB,EACpB,+BAA+B,EAC/B,oBAAoB,GACrB,MAAM,iBAAiB,CAAC;AACzB,OAAO,sBAAsB,MAAM,kBAAkB,CAAC;AAEtD;;;GAGG;AACH,kCAAkC;AAClC,yCAAyC;AACzC,mDAAmD;AACnD,2CAA2C;AAC3C,mGAAmG;AACnG,qDAAqD;AACrD,oEAAoE;AACpE,6BAA6B;AAC7B,MAAM;AACN,IAAI;AAEJ;;GAEG;AACH,+BAA+B;AAC/B,kEAAkE;AAClE,UAAU;AACV,2GAA2G;AAC3G,kBAAkB;AAClB,oBAAoB;AACpB,MAAM;AACN,IAAI;AAEJ;;;GAGG;AACH,mCAAmC;AACnC,UAAU;AACV,4BAA4B;AAC5B,sBAAsB;AACtB,6CAA6C;AAC7C,oDAAoD;AACpD,MAAM;AACN,IAAI;AAEJ;;;GAGG;AACH,MAAM,UAAU,YAAY,CAAC,IAAI;IAC/B,iDAAiD;IACjD,yBAAyB;IACzB,aAAa,CAAC,IAAI,CAAC,CAAC;IACpB,yBAAyB;IACzB,gBAAgB,CAAC,IAAI,CAAC,CAAC;IACvB,cAAc,CAAC,IAAI,CAAC,CAAC;IACrB,sBAAsB,CAAC,IAAI,CAAC,CAAC;IAC7B,oBAAoB,CAAC,IAAI,CAAC,CAAC;AAC7B,CAAC;AAED,SAAS,sBAAsB,CAAC,EAAE;IAChC,eAAe,CAAC,EAAE,CAAC,CAAC;IACpB,oBAAoB,CAAC,EAAE,CAAC,CAAC;IACzB,+BAA+B,CAAC,EAAE,CAAC,CAAC;AACtC,CAAC;AAED;;;GAGG;AACH,KAAK,UAAU,SAAS,CAAC,GAAG;IAC1B,IACE,WAAW,CAAC,YAAY,CAAC;QACzB,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC,UAAU,CAAC,CAAC,CAAC,MAAM;QAC9C,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC,UAAU,CAAC,CAAC,CAAC,MAAM,EAC9C,CAAC;QACD,MAAM,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,MAAM,MAAM,CAAC,UAAU,CAAC,CAAC;QACzD,MAAM,QAAQ,CAAC,QAAQ,EAAE,EAAE,SAAS,EAAE,SAAS,EAAE,EAAE,aAAa,CAAC,CAAC;IACpE,CAAC;IACD,wCAAwC;IAExC,MAAM,IAAI,GAAG,CAAC,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;IAC5B,IAAI,IAAI,EAAE,CAAC;QACT,UAAU,CAAC,CAAC,CAAC,GAAG,EAAE,QAAQ,CAAC,CAAC,CAAC;QAC7B,UAAU,CAAC,CAAC,CAAC,GAAG,EAAE,QAAQ,CAAC,CAAC,CAAC;QAC7B,wBAAwB,EAAE,CAAC;QAE3B,YAAY,CAAC,IAAI,CAAC,CAAC;QACnB,cAAc,EAAE,CAAC;QACjB,sBAAsB,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;QACjC,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;QACtC,uGAAuG;IACzG,CAAC;IAED,IAAI,CAAC;QACH,oFAAoF;QACpF,4EAA4E;QAC5E,iBAAiB;QACjB,IAAI;IACN,CAAC;IAAC,OAAO,GAAG,EAAE,CAAC;QACb,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QACnB,aAAa;IACf,CAAC;AACH,CAAC;AAED;;;GAGG;AACH,KAAK,UAAU,QAAQ,CAAC,GAAa;IACnC,MAAM,IAAI,GAAG,CAAC,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;IAC5B,MAAM,YAAY,CAAC,IAAI,CAAC,CAAC;IAEzB,oCAAoC;IACpC,wEAAwE;IACxE,iDAAiD;IACjD,OAAO,CAAC,GAAI,MAAc,CAAC,GAAG,CAAC,YAAY,yBAAyB,CAAC,CAAC;IACtE,eAAe;IAEf,MAAM,MAAM,GAAG,aAAa,CAAC,QAAQ,CAAsB,CAAC;IAC5D,MAAM,CAAC,KAAK,GAAG,IAAI,CAAC;IACpB,MAAM,CAAC,GAAG,GAAG,GAAI,MAAc,CAAC,GAAG,CAAC,YAAY,kBAAkB,CAAC;IACnE,MAAM,CAAC,IAAI,GAAG,QAAQ,CAAC;IACvB,UAAU,CAAC,GAAG,EAAE;QACd,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;IAC1B,CAAC,EAAE,CAAC,CAAC,CAAC;IAEN,IACE,WAAW,CAAC,YAAY,CAAC;QACzB,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC,UAAU,CAAC,CAAC,CAAC,MAAM;QAC9C,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC,UAAU,CAAC,CAAC,CAAC,MAAM,EAC9C,CAAC;QACD,MAAM,EAAE,QAAQ,EAAE,OAAO,EAAE,GAAG,MAAM,MAAM,CAAC,UAAU,CAAC,CAAC;QACvD,MAAM,OAAO,CAAC,QAAQ,EAAE,EAAE,SAAS,EAAE,SAAS,EAAE,EAAE,aAAa,CAAC,CAAC;IACnE,CAAC;AACH,CAAC;AAED;;;GAGG;AACH,SAAS,WAAW;IAClB,yDAAyD;IACzD,yDAAyD;AAC3D,CAAC;AAED,KAAK,UAAU,QAAQ;IACrB,MAAM,SAAS,CAAC,QAAQ,CAAC,CAAC;IAC1B,MAAM,QAAQ,CAAC,QAAQ,CAAC,CAAC;IACzB,WAAW,EAAE,CAAC;AAChB,CAAC;AAED,QAAQ,EAAE,CAAC","file":"scripts.js","sourcesContent":["import { $, createElement } from './__constants';\nimport {\n  AUDIENCES,\n  // buildBlock,\n  decorateBlocks,\n  decorateIcons,\n  decorateSections,\n  decorateTemplateAndTheme,\n  getAllMetadata,\n  getMetadata,\n  loadCSS,\n  loadFooter,\n  loadHeader,\n  // loadSection,\n  loadSections,\n  loadSkipToMain,\n  pluginContext,\n  pluginPath,\n  // waitForFirstImage,\n} from './aem.js';\n\nimport {\n  decorateButtons,\n  decorateDisplayTexts,\n  decorateIntroAndSmallParagraphs,\n  decorateSectionTitle,\n} from './decorators.js';\nimport decorateExternalImages from './external-image';\n\n/**\n * Builds hero block and prepends to main in a new section.\n * @param {Element} main The container element\n */\n// function buildHeroBlock(main) {\n//   const h1 = main.querySelector('h1');\n//   const picture = main.querySelector('picture');\n//   // eslint-disable-next-line no-bitwise\n//   if (h1 && picture && h1.compareDocumentPosition(picture) & Node.DOCUMENT_POSITION_PRECEDING) {\n//     const section = document.createElement('div');\n//     section.append(buildBlock('hero', { elems: [picture, h1] }));\n//     main.prepend(section);\n//   }\n// }\n\n/**\n * load fonts.css and set a session storage flag\n */\n// async function loadFonts() {\n//   await loadCSS(`${window.hlx.codeBasePath}/styles/fonts.css`);\n//   try {\n//     if (!window.location.hostname.includes('localhost')) sessionStorage.setItem('fonts-loaded', 'true');\n//   } catch (e) {\n//     // do nothing\n//   }\n// }\n\n/**\n * Builds all synthetic blocks in a container element.\n * @param {Element} main The container element\n */\n// function buildAutoBlocks(main) {\n//   try {\n//     buildHeroBlock(main);\n//   } catch (error) {\n//     // eslint-disable-next-line no-console\n//     console.error('Auto Blocking failed', error);\n//   }\n// }\n\n/**\n * Decorates the main element.\n * @param {Element} main The main element\n */\nexport function decorateMain(main) {\n  // hopefully forward compatible button decoration\n  // decorateButtons(main);\n  decorateIcons(main);\n  // buildAutoBlocks(main);\n  decorateSections(main);\n  decorateBlocks(main);\n  decorateExternalImages(main);\n  decorateSectionTitle(main);\n}\n\nfunction invokeCustomDecorators(el) {\n  decorateButtons(el);\n  decorateDisplayTexts(el);\n  decorateIntroAndSmallParagraphs(el);\n}\n\n/**\n * Loads everything needed to get to LCP.\n * @param {Element} doc The container element\n */\nasync function loadEager(doc) {\n  if (\n    getMetadata('experiment') ||\n    Object.keys(getAllMetadata('campaign')).length ||\n    Object.keys(getAllMetadata('audience')).length\n  ) {\n    const { loadEager: runEager } = await import(pluginPath);\n    await runEager(document, { audiences: AUDIENCES }, pluginContext);\n  }\n  // document.documentElement.lang = 'en';\n\n  const main = $(doc, 'main');\n  if (main) {\n    loadHeader($(doc, 'header'));\n    loadFooter($(doc, 'footer'));\n    decorateTemplateAndTheme();\n\n    decorateMain(main);\n    loadSkipToMain();\n    invokeCustomDecorators(doc.body);\n    document.body.classList.add('appear');\n    // aditya await loadSection($(main as HTMLElement, '.section-content'), () => {}); // waitForFirstImage\n  }\n\n  try {\n    /* if desktop (proxy for fast connection) or fonts already loaded, load fonts.css */\n    // if (window.innerWidth >= 900 || sessionStorage.getItem('fonts-loaded')) {\n    //   loadFonts();\n    // }\n  } catch (err) {\n    console.error(err);\n    // do nothing\n  }\n}\n\n/**\n * Loads everything that doesn't need to be delayed.\n * @param {Element} doc The container element\n */\nasync function loadLazy(doc: Document) {\n  const main = $(doc, 'main');\n  await loadSections(main);\n\n  // const { hash } = window.location;\n  // const element = hash ? doc.getElementById(hash.substring(1)) : false;\n  // if (hash && element) element.scrollIntoView();\n  loadCSS(`${(window as any).hlx.codeBasePath}/styles/lazy-styles.css`);\n  // loadFonts();\n\n  const headEl = createElement('script') as HTMLScriptElement;\n  headEl.defer = true;\n  headEl.src = `${(window as any).hlx.codeBasePath}/scripts/head.js`;\n  headEl.type = 'module';\n  setTimeout(() => {\n    doc.head.append(headEl);\n  }, 0);\n\n  if (\n    getMetadata('experiment') ||\n    Object.keys(getAllMetadata('campaign')).length ||\n    Object.keys(getAllMetadata('audience')).length\n  ) {\n    const { loadLazy: runLazy } = await import(pluginPath);\n    await runLazy(document, { audiences: AUDIENCES }, pluginContext);\n  }\n}\n\n/**\n * Loads everything that happens a lot later,\n * without impacting the user experience.\n */\nfunction loadDelayed() {\n  // window.setTimeout(() => import('./delayed.ts'), 3000);\n  // load anything that can be postponed to the latest here\n}\n\nasync function loadPage() {\n  await loadEager(document);\n  await loadLazy(document);\n  loadDelayed();\n}\n\nloadPage();\n"]}